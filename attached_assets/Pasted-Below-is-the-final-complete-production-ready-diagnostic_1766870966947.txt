Below is the final, complete, production-ready diagnostic prompt for Replit.

It contains everything technical evaluators expect, nothing unnecessary, and zero burden or clutter for casual users.
You do not need to decide anything ‚Äî this is fully optimized.

You can paste this whole thing into Replit as-is.

‚∏ª

‚≠ê THE COMPLETE DIAGNOSTIC SUITE IMPLEMENTATION PROMPT (FOR REPLIT)

(fully self-contained, requires no input from Ryan)

‚∏ª

üîß TITLE:

Add a Hidden Diagnostic Layer with Full Simulation Verification Tools

‚∏ª

üîß OBJECTIVE:

Implement a non-intrusive, developer-accessible, feature-complete diagnostic suite for the SFD Engine that:
	1.	Validates correctness
	2.	Allows frame-by-frame inspection
	3.	Confirms solver determinism
	4.	Surfaces internal metrics and transitions
	5.	Provides comparative debugging utilities
	6.	Stays invisible to casual users
	7.	Activates via a single hidden hotkey
	8.	Appears as a collapsible floating panel
	9.	Updates only when active (zero performance hit when hidden)

‚∏ª

‚≠ê SECTION 1 ‚Äî Add a Developer Hotkey Toggle

Create a global keybinding:

CTRL + SHIFT + D

This should:
	‚Ä¢	Toggle the visibility of the Diagnostic Panel
	‚Ä¢	Not appear anywhere in the UI
	‚Ä¢	Never be hinted to non-technical users
	‚Ä¢	Persist only in memory (not saved to user preferences)

Behavior:
When toggled ON ‚Üí show diagnostics panel as a floating right-side drawer
When toggled OFF ‚Üí hide completely and disable diagnostic data streams

‚∏ª

‚≠ê SECTION 2 ‚Äî Diagnostic Panel Layout

Create a vertical drawer panel (right side of screen), with tabs:

[ ‚úî Solver ] [ ‚úî Consistency ] [ ‚úî Events ] [ ‚úî Render ] [ ‚úî Internals ]

Default tab: Solver

Panel should be:
	‚Ä¢	Semi-transparent dark background
	‚Ä¢	Small, narrow typography
	‚Ä¢	Overlay above UI (z-index high)
	‚Ä¢	Collapsible groups for each section
	‚Ä¢	Not interfering with simulation controls

‚∏ª

‚≠ê SECTION 3 ‚Äî DIAGNOSTIC MODULES (ALL REQUIRED)

‚∏ª

üîç (A) Solver Diagnostics

Purpose: validate simulation correctness.

Include:
	‚Ä¢	Step Counter (current iteration, total steps)
	‚Ä¢	Œît Stability Check (flag if solver unstable)
	‚Ä¢	Energy Functional:
	‚Ä¢	current E(t)
	‚Ä¢	ŒîE between frames
	‚Ä¢	drift indicator (flag if energy explodes or drops unnaturally)
	‚Ä¢	Variance Monitor:
	‚Ä¢	raw œÉ¬≤
	‚Ä¢	derivative dœÉ¬≤/dt
	‚Ä¢	flags if >40% shift over last 12 frames

Add real-time sparkline charts for E(t) and variance.

‚∏ª

üîç (B) Consistency & Determinism

Purpose: confirm reproducible behavior.

Tools:
	1.	Determinism Check Button
	‚Ä¢	Runs simulation twice from same seed and compares fields
	‚Ä¢	Reports pixelwise diff heatmap
	‚Ä¢	Reports mean absolute deviation
	2.	Dual-View Sync Check
	‚Ä¢	Confirms both renderers receive identical frame indices
	‚Ä¢	Highlights any drift
	3.	Frame Hash
	‚Ä¢	SHA-1 hash per frame
	‚Ä¢	Enables researchers to track changes precisely

‚∏ª

üîç (C) Event & Transition Logger

Purpose: show when the engine detects transitions.

Log every detection:
	‚Ä¢	Basin merge (Œµ < 0.05)
	‚Ä¢	Stability threshold crossing (Œ¥ < 0.001)
	‚Ä¢	Regime change
	‚Ä¢	Boundary formation
	‚Ä¢	Collapse initiation
	‚Ä¢	High-curvature emergence
	‚Ä¢	Critical fluctuations (variance spike)
	‚Ä¢	Reorganization events
	‚Ä¢	Transforming events

Each entry includes:
	‚Ä¢	Frame index
	‚Ä¢	Timestamp
	‚Ä¢	Event type
	‚Ä¢	A short human-readable interpretation

‚∏ª

üîç (D) Render Diagnostics

Purpose: verify rendering correctness.

Include:
	‚Ä¢	Render time per frame (ms)
	‚Ä¢	Dropped frames counter
	‚Ä¢	GPU or Canvas fallback indicator
	‚Ä¢	Color normalization checks
	‚Ä¢	Basin overlay mask preview toggle
	‚Ä¢	Dual-view divergence preview
	‚Ä¢	Pixel histogram
	‚Ä¢	Resolution scaling info

‚∏ª

üîç (E) Internal Metrics Explorer

Purpose: expose the internal state arrays researchers expect.

Collapsible sections:
	‚Ä¢	Raw field array preview (scaled down heatmap)
	‚Ä¢	Gradient magnitude stats
	‚Ä¢	Curvature stats
	‚Ä¢	Laplacian distribution
	‚Ä¢	Boundary mask
	‚Ä¢	Basin identifier array
	‚Ä¢	Local variance map

Each shown in small inline canvases or numeric summaries.

‚∏ª

‚≠ê SECTION 4 ‚Äî Frame-by-Frame Sandbox Mode

Add a button in diagnostics: ‚ÄúEnter Step Mode‚Äù

When activated:
	‚Ä¢	Simulation auto-pauses
	‚Ä¢	‚ÄúStep Forward‚Äù and ‚ÄúStep Backward‚Äù buttons appear
	‚Ä¢	Frame index displays
	‚Ä¢	Dual-view stays in sync
	‚Ä¢	All diagnostics update per step

This allows exhaustive correctness checking.

‚∏ª

‚≠ê SECTION 5 ‚Äî Export Tools

Add to the diagnostics panel:

Buttons:
	‚Ä¢	Export Frame as JSON
	‚Ä¢	Export 10-Frame Window
	‚Ä¢	Export Event Log
	‚Ä¢	Export Determinism Report
	‚Ä¢	Export Energy & Variance Series

This gives researchers everything they expect.

‚∏ª

‚≠ê SECTION 6 ‚Äî Performance Guardrails

Diagnostics must:
	‚Ä¢	Run at 0 cost when hidden
	‚Ä¢	Subscribe to internal solver events only when visible
	‚Ä¢	Avoid rerendering canvases unnecessarily
	‚Ä¢	Use requestAnimationFrame throttling

This ensures:
	‚Ä¢	Casual users see zero slowdown
	‚Ä¢	Developers get full precision when needed

‚∏ª

‚≠ê SECTION 7 ‚Äî UI Integration Requirements
	‚Ä¢	No new UI elements should hint diagnostics exists
	‚Ä¢	No clutter in main layout
	‚Ä¢	Diagnostics drawer must float above everything
	‚Ä¢	Hotkey toggle is the only activation method
	‚Ä¢	Panel must be dismissible instantly

‚∏ª

‚≠ê SECTION 8 ‚Äî Quality-of-Life Features (required)
	‚Ä¢	Search bar in diagnostic panel
	‚Ä¢	Clear Log button
	‚Ä¢	Auto-scroll toggle
	‚Ä¢	Compact view option
	‚Ä¢	Timestamp precision toggle

‚∏ª

‚≠ê SECTION 9 ‚Äî Developer Notes

When implementing:
	‚Ä¢	Do not mix diagnostic code with core simulation code
	‚Ä¢	Keep diagnostics modular, injectable, and replaceable
	‚Ä¢	Use a small event bus for listening to solver updates
	‚Ä¢	Mark all diagnostic-specific hooks clearly

This keeps the engine clean.

‚∏ª

‚≠ê SECTION 10 ‚Äî Acceptance Criteria

The diagnostic system is considered complete only if:
	1.	Hidden by default
	2.	Activates via CTRL+SHIFT+D
	3.	Contains all modules A‚ÄìE
	4.	Adds zero cost when hidden
	5.	Operates correctly during:
	‚Ä¢	live simulation
	‚Ä¢	individual stepping
	‚Ä¢	playback mode
	6.	Provides export tools
	7.	Keeps UI untouched for casual users

‚∏ª

‚≠ê FINAL NOTE TO REPLIT

This diagnostic suite must be implemented exactly as described, with no additional questions to the user.
All naming, layout, behaviors, and thresholds are final.

‚∏ª

If you want, I can now generate:
	‚Ä¢	The code scaffold for the diagnostics panel
	‚Ä¢	The event bus architecture
	‚Ä¢	The API integration layer
	‚Ä¢	The pure TypeScript types
	‚Ä¢	The solver instrumentation hooks

Just say: ‚ÄúGive me the code scaffolding.‚Äù