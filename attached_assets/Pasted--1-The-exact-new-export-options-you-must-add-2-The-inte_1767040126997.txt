
	1.	The exact new export options you must add
	2.	The internal logic each one performs
	3.	The full copy-paste Replit prompt to implement every feature correctly
	4.	Zero ambiguity ‚Äî I take all decisions out of your hands

This is the definitive upgrade to your Export system.

‚∏ª

‚úÖ NEW EXPORT OPTIONS TO ADD (FINAL, COMPLETE SET)

You already have these:
	‚Ä¢	PNG Snapshot
	‚Ä¢	Animation Export (GIF)
	‚Ä¢	Simulation Data (CSV)
	‚Ä¢	Metrics Log (CSV)
	‚Ä¢	State Snapshot (JSON)
	‚Ä¢	Settings JSON
	‚Ä¢	Event Log

Now add the true research-grade ones:

‚∏ª

‚≠ê (1) Full Data Archive (.zip)

Contains EVERYTHING needed for a researcher to reconstruct the simulation externally.

Archive includes:

field_####.npy      (each frame)
operators.csv       (operator contribution time series)
metrics.csv         (field-level metrics per frame)
events.json         (event log)
config.json         (full params)
readme.txt          (auto-generated)

This option is mandatory for any lab.

‚∏ª

‚≠ê (2) NumPy Array Export (.npy)

Exports the current frame as a 2D or 3D NumPy array, depending on representation.

This is the most requested scientific format.

‚∏ª

‚≠ê (3) Python Reconstruction Script (.py)

Generates a runnable Python script that:
	‚Ä¢	loads field data
	‚Ä¢	plots it
	‚Ä¢	optionally animates it
	‚Ä¢	prints metrics
	‚Ä¢	recreates the visualization

This is what lets researchers drop your output into Jupyter, Google Colab, or their internal analysis pipelines.

‚∏ª

‚≠ê (4) MP4 / WebM Simulation Video Export

The GIF is fine for casual use, but researchers need:
	‚Ä¢	MP4 or WebM
	‚Ä¢	60fps or time-scaled
	‚Ä¢	Clean borderless rendering

This is for presentations and talks.

‚∏ª

‚≠ê (5) Minimal JSON Batch Spec Export

This generates a tiny JSON spec:

{
  "params": {
    "curvature": 0.82,
    "coupling": 0.12,
    "redistribution": 0.06
  },
  "steps": 3500,
  "seed": 112233
}

This enables automated batch testing.

‚∏ª

‚≠ê (6) Layer-Separated Export (PNG or NPZ)

For Projection View and multi-layer analysis.

Creates:

layer_curvature.png
layer_tension.png
layer_coupling.png
layer_attractor.png

Or combined .npz bundle.

This is a high-value analytic feature.

‚∏ª

üî• THE COMPLETE EXPORT PANEL (FINAL VERSION)

This is exactly how your export panel should look after adding everything:

Export Options
--------------------------------
PNG Snapshot
Animation Export (GIF)
Simulation Video (MP4)
Simulation Data (.csv)
Metrics Log (.csv)
Operator Contributions (.csv)
NumPy Array Export (.npy)
State Snapshot (.json)
Settings JSON
Batch Spec JSON
Event Log
Layer Export (.npz)
Full Data Archive (.zip)
Python Reconstruction Script (.py)

This is the canonical set.

It matches scientific software, visualization environments, and simulation engines used in top labs.

‚∏ª

‚úÖ NOW: THE COPY-PASTE PROMPT FOR REPLIT (BUILD ALL FEATURES)

This is what you paste into Replit‚Äôs agent or your coding Copilot.
It contains everything required to add the above features.

‚∏ª

üìå REPLIT PROMPT ‚Äî ‚ÄúAdd Full Export System to SFD Engine‚Äù

Paste this whole block exactly:

‚∏ª

BEGIN PROMPT

Implement the following feature upgrade to the SFD Engine Export system.
Do not modify existing export features ‚Äî only add the new ones listed.

ADD THESE NEW EXPORT MODES
	1.	Full Data Archive (.zip)
	‚Ä¢	Generate a ZIP containing:
	‚Ä¢	Per-frame field arrays (field_####.npy)
	‚Ä¢	Operator contributions over time (operators.csv)
	‚Ä¢	Metrics time series (metrics.csv)
	‚Ä¢	Full event log (events.json)
	‚Ä¢	Simulation config (config.json)
	‚Ä¢	Auto-generated readme.txt explaining each file
	‚Ä¢	Use lossless compression.
	‚Ä¢	Use a timestamped filename: sfd_export_YYYYMMDD_HHMMSS.zip.
	2.	NumPy Export (.npy)
	‚Ä¢	Export the current field grid as a NumPy array.
	‚Ä¢	Filename: field_current.npy.
	‚Ä¢	Use ArrayBuffer ‚Üí Float32Array ‚Üí npy compatible writer.
	3.	Python Reconstruction Script (.py)
	‚Ä¢	Auto-generate a script named reconstruct_simulation.py that:
	‚Ä¢	Loads .npy and .csv files
	‚Ä¢	Plots the frame using matplotlib
	‚Ä¢	Computes basic metrics
	‚Ä¢	Optionally animates if multiple frames are present
	‚Ä¢	Include comments and usage instructions.
	4.	Simulation Video Export (MP4 or WebM)
	‚Ä¢	Render the playback frames at 30fps or user-selected FPS.
	‚Ä¢	Use offscreen canvas rendering.
	‚Ä¢	Provide MP4 where supported; fallback to WebM.
	5.	Batch Spec JSON
	‚Ä¢	Export a minimal JSON file containing only:

params: { all simulation parameters }
steps: total steps
seed: RNG seed


	‚Ä¢	Filename: batch_spec.json.

	6.	Layer Export (.npz or separate PNGs)
	‚Ä¢	Export each structural layer (curvature, tension, coupling, attractor, redistribution) individually.
	‚Ä¢	Provide option:
	‚Ä¢	.npz file containing arrays for all layers
	‚Ä¢	OR separate .png files for each layer.

UI Requirements
	‚Ä¢	Add each export option to the existing Export panel as a button with identical styling.
	‚Ä¢	Ensure buttons trigger asynchronous file generation.
	‚Ä¢	Show a temporary toast notification on successful export.

Implementation Notes
	‚Ä¢	Use existing simulation state and data structures.
	‚Ä¢	Do NOT block the UI thread during archive/video generation.
	‚Ä¢	Use Web Workers where needed.
	‚Ä¢	Keep file generation consistent across browsers.

END PROMPT